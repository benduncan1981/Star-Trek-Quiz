<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Star Trek Flagship Quiz</title>

<style>
:root{
--lcars-orange:#ff9900;
--lcars-purple:#cc99ff;
--lcars-blue:#66ccff;
--lcars-red:#ff4444;
--bg:#000;
--panel:#111;
}

body{
margin:0;
background:black;
color:white;
font-family:Arial,Helvetica,sans-serif;
overflow:hidden;
}

/* Starfield */
body::before{
content:"";
position:fixed;
width:200%;
height:200%;
background:radial-gradient(white 1px, transparent 1px);
background-size:3px 3px;
animation:stars 80s linear infinite;
opacity:0.15;
}
@keyframes stars{
from{transform:translateY(0);}
to{transform:translateY(-1200px);}
}

#app{
position:relative;
z-index:2;
max-width:950px;
margin:20px auto;
background:var(--panel);
border-radius:40px;
padding:20px;
box-shadow:0 0 40px var(--lcars-orange);
}

/* LCARS header */
.header{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:15px;
}

.lcars-pill{
background:var(--lcars-orange);
color:black;
padding:8px 14px;
border-radius:50px;
font-weight:bold;
}

#stats{
font-size:0.85rem;
color:var(--lcars-blue);
}

.screen{
display:none;
animation:fade 0.4s ease;
}
.screen.active{display:block;}

@keyframes fade{
from{opacity:0;transform:translateY(10px);}
to{opacity:1;transform:translateY(0);}
}

.btn{
width:100%;
padding:12px;
margin:8px 0;
border:none;
border-radius:30px;
background:#222;
color:white;
font-size:1rem;
cursor:pointer;
transition:all 0.2s ease;
}
.btn:hover{background:var(--lcars-orange);color:black;}

.correct{background:#2ecc71 !important;color:black;}
.wrong{background:var(--lcars-red) !important;}

#progressContainer{
height:8px;
background:#333;
border-radius:4px;
margin:10px 0;
}
#progress{
height:8px;
width:0%;
background:var(--lcars-orange);
border-radius:4px;
transition:width 0.3s ease;
}

#timerBar{
height:6px;
background:var(--lcars-blue);
border-radius:3px;
transition:width 1s linear, background 0.3s ease;
}

select{
width:100%;
padding:10px;
border-radius:20px;
margin:10px 0;
background:#222;
color:white;
border:none;
}

.toggle{
cursor:pointer;
color:var(--lcars-purple);
font-size:0.85rem;
}
</style>
</head>
<body>

<div id="app">

<div class="header">
<div class="lcars-pill">STAR TREK FLAGSHIP QUIZ</div>
<div id="stats"></div>
</div>

<!-- MENU -->
<div id="menu" class="screen active">
<h2>Select Era</h2>
<select id="eraSelect">
<option value="all">All Eras</option>
<option value="tos">TOS / 23rd Century</option>
<option value="tng">TNG / 24th Century</option>
<option value="modern">Modern Trek</option>
</select>

<h2>Select Difficulty</h2>
<select id="difficultySelect">
<option value="easy">Easy</option>
<option value="medium" selected>Medium</option>
<option value="hard">Hard</option>
</select>

<button class="btn" onclick="startGame()">Begin Mission</button>
<div class="toggle" onclick="toggleAudio()">Audio: <span id="audioState">On</span></div>
</div>

<!-- QUIZ -->
<div id="quizScreen" class="screen">
<div id="questionCount"></div>
<div id="progressContainer"><div id="progress"></div></div>
<div id="timerBar"></div>
<div id="question"></div>
<div id="answers"></div>
</div>

<!-- RESULTS -->
<div id="resultScreen" class="screen">
<h2>Mission Complete</h2>
<div id="finalStats"></div>
<button class="btn" onclick="location.reload()">Return to Starbase</button>
</div>

</div>

<script>

/* QUESTION POOL */

const questionPool=[
{era:"tos",q:"Spock’s home planet?",a:["Romulus","Vulcan","Qo'noS","Andoria"],c:1},
{era:"tos",q:"Kirk commands?",a:["Enterprise","Voyager","Defiant","Discovery"],c:0},
{era:"tng",q:"Picard’s catchphrase?",a:["Engage","Make it so","Warp me","Execute"],c:1},
{era:"tng",q:"DS9 orbits?",a:["Cardassia","Bajor","Earth","Romulus"],c:1},
{era:"tng",q:"Borg are?",a:["Klingons","Collective","Romulans","Dominion"],c:1},
{era:"modern",q:"Discovery jumps to which century?",a:["30th","31st","32nd","33rd"],c:2},
{era:"modern",q:"Protostar appears in?",a:["Picard","Prodigy","SNW","LD"],c:1},
{era:"modern",q:"Seven returns in?",a:["Discovery","Picard","SNW","LD"],c:1},
];

/* EXPAND TO 50 */
while(questionPool.length<50){
let base=questionPool[Math.floor(Math.random()*8)];
questionPool.push({...base});
}

/* STATE */
let questions=[];
let current=0;
let score=0;
let timerInterval;
let timeLeft=15;
let difficultyMultiplier=1;
let audioEnabled=true;

/* DOM */
const menu=document.getElementById("menu");
const quizScreen=document.getElementById("quizScreen");
const resultScreen=document.getElementById("resultScreen");
const questionEl=document.getElementById("question");
const answersEl=document.getElementById("answers");
const questionCount=document.getElementById("questionCount");
const progress=document.getElementById("progress");
const timerBar=document.getElementById("timerBar");
const stats=document.getElementById("stats");

/* INIT STATS */
let profile=JSON.parse(localStorage.getItem("trekProfile"))||{missions:0,highScore:0};
updateStats();

function updateStats(){
stats.textContent=`Missions: ${profile.missions} | High Score: ${profile.highScore}`;
}

/* START GAME */
function startGame(){
const era=document.getElementById("eraSelect").value;
const diff=document.getElementById("difficultySelect").value;

difficultyMultiplier= diff==="easy"?1: diff==="medium"?2:3;
timeLeft= diff==="easy"?20: diff==="medium"?15:10;

questions=questionPool.filter(q=>era==="all"||q.era===era);
questions=shuffle(questions).slice(0,50);

current=0;
score=0;

menu.classList.remove("active");
quizScreen.classList.add("active");

loadQuestion();
}

/* LOAD */
function loadQuestion(){
if(current>=questions.length){endGame();return;}

const q=questions[current];

questionCount.textContent=`Question ${current+1} / 50`;
progress.style.width=((current/50)*100)+"%";

questionEl.innerHTML=`<h3>${q.q}</h3>`;
answersEl.innerHTML="";

let shuffledAnswers=shuffle(q.a.map((text,i)=>({text,index:i})));

shuffledAnswers.forEach(ans=>{
let btn=document.createElement("button");
btn.className="btn";
btn.textContent=ans.text;
btn.onclick=()=>checkAnswer(ans.index,btn);
answersEl.appendChild(btn);
});

startTimer();
}

/* TIMER */
function startTimer(){
timerBar.style.width="100%";
timerBar.style.background="var(--lcars-blue)";
let total=timeLeft;
let remaining=total;
clearInterval(timerInterval);
timerInterval=setInterval(()=>{
remaining--;
timerBar.style.width=(remaining/total*100)+"%";
if(remaining<=5) timerBar.style.background="var(--lcars-red)";
if(remaining<=0){
clearInterval(timerInterval);
nextQuestion();
}
},1000);
}

/* ANSWER */
function checkAnswer(index,btn){
clearInterval(timerInterval);
let correct=questions[current].c;
let buttons=document.querySelectorAll(".btn");
buttons.forEach(b=>b.disabled=true);

if(index===correct){
score+=difficultyMultiplier;
btn.classList.add("correct");
beep(600);
}else{
btn.classList.add("wrong");
buttons.forEach(b=>{
if(b.textContent===questions[current].a[correct]) b.classList.add("correct");
});
beep(200);
}

setTimeout(nextQuestion,800);
}

function nextQuestion(){current++;loadQuestion();}

/* END */
function endGame(){
quizScreen.classList.remove("active");
resultScreen.classList.add("active");

profile.missions++;
if(score>profile.highScore) profile.highScore=score;
localStorage.setItem("trekProfile",JSON.stringify(profile));
updateStats();

let rank="Ensign";
if(score>100) rank="Fleet Admiral";
else if(score>70) rank="Captain";
else if(score>40) rank="Commander";

document.getElementById("finalStats").innerHTML=
`Score: ${score}<br>Rank: ${rank}<br>Missions Completed: ${profile.missions}`;
}

/* UTILS */
function shuffle(arr){
return arr.sort(()=>Math.random()-0.5);
}

function beep(freq){
if(!audioEnabled) return;
let ctx=new (window.AudioContext||window.webkitAudioContext)();
let osc=ctx.createOscillator();
osc.frequency.value=freq;
osc.connect(ctx.destination);
osc.start();
setTimeout(()=>osc.stop(),100);
}

function toggleAudio(){
audioEnabled=!audioEnabled;
document.getElementById("audioState").textContent=audioEnabled?"On":"Off";
}

</script>
</body>
</html>
