<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Star Trek: Ultimate Challenge</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
<style>
body {
    margin:0;
    font-family:'Orbitron', sans-serif;
    background:#000;
    color:#fff;
    overflow-x:hidden;
}
.lcars-panel {
    background:#111;
    border:4px solid #ff9900;
    padding:20px;
    margin:20px auto;
    border-radius:15px;
    max-width:480px;
    text-align:center;
}
h1,h2,h3 {margin:10px;}
button {
    display:block;
    margin:10px auto;
    padding:12px 20px;
    font-size:16px;
    cursor:pointer;
    border:none;
    border-radius:8px;
    background:#ff9900;
    color:#000;
    transition:0.1s;
}
button:active { transform:scale(0.97); }
#timer-bar {
    width:100%;
    height:12px;
    background:#333;
    margin-top:10px;
    border-radius:6px;
    overflow:hidden;
}
#timer-fill {
    width:100%;
    height:100%;
    background:#ff9900;
    transition:width 1s linear;
}
.fanfare {
    color:#0f0;
    font-size:24px;
    font-weight:bold;
    animation:flash 0.5s alternate infinite;
    margin-top:15px;
}
@keyframes flash {
    0%{color:#0f0;}
    100%{color:#fff;}
}
input {
    padding:12px;
    font-size:20px;
    width:60%;
    text-align:center;
    text-transform:uppercase;
    margin-bottom:10px;
    border-radius:6px;
    border:none;
}
</style>
</head>
<body>

<div id="intro" class="lcars-panel">
    <h1>STAR TREK: ULTIMATE CHALLENGE</h1>
    <p>Enter your initials (2–3 letters), press ENGAGE, and test your Star Trek knowledge across all eras! Questions get harder as you progress. Beat 80% for a fanfare!</p>
    <input id="initials" maxlength="3" placeholder="ABC">
    <button onclick="startQuiz()">ENGAGE</button>
</div>

<div id="quiz" class="lcars-panel" style="display:none;">
    <div id="question-number"></div>
    <div id="question-text"></div>
    <div id="answers"></div>
    <div id="timer-bar"><div id="timer-fill"></div></div>
    <div id="streak"></div>
</div>

<div id="end" class="lcars-panel" style="display:none;">
    <h2>Quiz Complete!</h2>
    <div id="score-display"></div>
    <div id="fanfare-msg" class="fanfare" style="display:none;">STARFLEET MASTER ACHIEVED!</div>
    <h3>Leaderboard</h3>
    <ol id="leaderboard"></ol>
    <button onclick="restart()">RETRY</button>
</div>

<script>
// ======= 100 STAR TREK QUESTIONS =======
const quizData = [
{question:"Which starship is commanded by Captain James T. Kirk?",answers:["USS Enterprise","USS Voyager","USS Defiant","USS Discovery"],correct:0},
{question:"What is Spock’s home planet?",answers:["Vulcan","Romulus","Qo'noS","Andoria"],correct:0},
{question:"Who commands the USS Enterprise‑D?",answers:["Jean‑Luc Picard","James Kirk","Jonathan Archer","Benjamin Sisko"],correct:0},
{question:"Which Starfleet directive forbids interference with primitive cultures?",answers:["Prime Directive","Omega Directive","Temporal Directive","First Contact Protocol"],correct:0},
{question:"Which species is known for saying 'Resistance is futile'?",answers:["Borg","Klingon","Romulan","Ferengi"],correct:0},
{question:"What warp core matter/antimatter system component regulates the reaction?",answers:["Dilithium crystals","Tricobalt device","Omega particle","Transwarp coil"],correct:0},
{question:"Which series introduced the Maquis?",answers:["Deep Space Nine","Enterprise","Voyager","The Original Series"],correct:0},
{question:"Who is the chief medical officer aboard Deep Space Nine for most of the series?",answers:["Dr. Julian Bashir","Dr. McCoy","Dr. Crusher","Dr. Pulaski"],correct:0},
{question:"Which alien race uses neural parasites called Pah‑wraiths?",answers:["Bajorans","Cardassians","Vulcans","Romulans"],correct:0},
{question:"Which ship is stranded in the Delta Quadrant?",answers:["USS Voyager","USS Enterprise","USS Defiant","USS Excelsior"],correct:0},

// 11-20 Moderate
{question:"Which prequel series is set in the 22nd century?",answers:["Star Trek: Enterprise","Star Trek: Discovery","Strange New Worlds","The Original Series"],correct:0},
{question:"Who is captain of the NX‑01 Enterprise?",answers:["Jonathan Archer","Christopher Pike","Jean‑Luc Picard","James Kirk"],correct:0},
{question:"The Romulan ship Narada creates which alternate timeline?",answers:["Kelvin timeline","Prime timeline","Mirror timeline","Temporal timeline"],correct:0},
{question:"Which Star Trek film features the villain Nero?",answers:["Star Trek (2009)","Star Trek Into Darkness","Star Trek Beyond","First Contact"],correct:0},
{question:"Which Klingon leader is first seen in Enterprise?",answers:["Kang","Kor","Koloth","Martok"],correct:0},
{question:"Which series introduced the Temporal Cold War?",answers:["Enterprise","TOS","Deep Space Nine","Voyager"],correct:0},
{question:"Which captain is first featured in Strange New Worlds?",answers:["Christopher Pike","James Kirk","Jean‑Luc Picard","Jonathan Archer"],correct:0},
{question:"Which animated series focuses on the USS Cerritos?",answers:["Lower Decks","Prodigy","TOS Animated","Short Treks"],correct:0},
{question:"Who created the android Data?",answers:["Dr. Noonien Soong","Zefram Cochrane","Montgomery Scott","Reginald Barclay"],correct:0},
{question:"Which series jumps forward into the 32nd century?",answers:["Star Trek: Discovery","Star Trek: Picard","Enterprise","Voyager"],correct:0},

// 21-40 Moderate/Hard
{question:"What is the Klingon homeworld called?",answers:["Qo'noS","Bajor","Romulus","Vulcan"],correct:0},
{question:"What device allows instantaneous transport between two points?",answers:["Transporter","Warp drive","Deflector array","Subspace conduit"],correct:0},
{question:"Which Romulan homeworld was destroyed?",answers:["Romulus","Remus","Qo'noS","Vulcan"],correct:0},
{question:"Which treaty ended the Earth‑Romulan War?",answers:["Treaty of Algeron","Khitomer Accords","Rihannsu Treaty","Peace of Betazed"],correct:0},
{question:"Which technological tool performs non‑surgical medical healing?",answers:["Medical tricorder","Warp coil","Deflector shield","Biofilter"],correct:0},
{question:"What species created the Iconian gateways?",answers:["Iconians","Vulcans","Romulans","Klingons"],correct:0},
{question:"Which ship is primary in Star Trek: Lower Decks?",answers:["USS Cerritos","USS Voyager","USS Enterprise‑D","USS Discovery"],correct:0},
{question:"Which series explores Jean‑Luc Picard decades after TNG?",answers:["Star Trek: Picard","Deep Space Nine","VOY","ENT"],correct:0},
{question:"Which android joins Picard’s crew and was created by Dr. Soong?",answers:["Data","Lore","B‑4","Altan Inigo Soong"],correct:0},
{question:"What is the Bajoran spiritual entity known as the Prophets’ realm?",answers:["Celestial Temple","Fire Caves","Great Link","Continuum"],correct:0},
{question:"Which Dominion species comprises the Jem’Hadar?",answers:["Dominion","Federation","Cardassians","Romulans"],correct:0},
{question:"Which species controls the Great Link?",answers:["Founders","Borg","Gorn","Andorians"],correct:0},
{question:"Who eventually becomes captain of the USS Voyager?",answers:["Kathryn Janeway","Tuvok","Chakotay","B’Elanna Torres"],correct:0},
{question:"What is the name of the holographic doctor on Voyager?",answers:["The Doctor","Julian Bashir","McCoy","Phlox"],correct:0},
{question:"Which Starfleet captain refuses to violate the Prime Directive in ‘Darmok’?",answers:["Picard","Kirk","Sisko","Janeway"],correct:0},
{question:"Which Klingon chancellor appears in Star Trek VI?",answers:["Gorkon","Kang","Kor","Martok"],correct:0},

// 41–60 Hard
{question:"What is the highest rank visibly worn by Starfleet officers in TNG era?",answers:["Admiral","Captain","Commander","Lieutenant"],correct:0},
{question:"What phenomenon powered the Borg transwarp conduit?",answers:["Transwarp coils","Subspace inversion","Quantum singularity","Omega particles"],correct:0},
{question:"Which Borg drone was separated and named on Voyager?",answers:["Hugh","Seven of Nine","Locutus","Third of Five"],correct:0},
{question:"Which Vulcan practice suppresses emotion strictly?",answers:["Kolinar","IDIC","Khitomer","Kalite"],correct:0},
{question:"Which shipyards built the USS Enterprise‑E?",answers:["Utopia Planitia","Deep Space Nine Shipyards","Mars Shipyards","Starfleet Fleet Yards"],correct:0},
{question:"Who is the founder of the Terran Empire in Mirror Universe canon?",answers:["Captain James T. Kirk","Spock","Janeway","Picard"],correct:0},
{question:"Which philosopher’s writings influence Vulcan culture?",answers:["Surak","Sarek","T’Pau","Solok"],correct:0},
{question:"What is the designation of the Defiant‑class prototype?",answers:["USS Defiant","USS Valiant","USS Prometheus","USS Cheyenne"],correct:0},
{question:"In Picard, what synthetic was key to the first season plot?",answers:["Soong synthetic","Borg cube","Q entity","Section 31 agent"],correct:0},
{question:"Which Star Trek film is the first to feature the Borg?",answers:["First Contact","The Undiscovered Country","Generations","Insurrection"],correct:0},
{question:"Which phenomenon allowed Voyager to cross great distances quickly?",answers:["Transwarp hub","Wormhole","Slipstream","Spatial fold"],correct:0},
{question:"What species attacked Federation outposts in TNG ‘The Wounded’?",answers:["Cardassians","Romulans","Klingons","Borg"],correct:0},
{question:"Which world hosts the Bajoran wormhole?",answers:["Bajor","Risa","Qo'noS","Betazed"],correct:0},
{question:"Who is the creator of the EMH program?",answers:["Dr. Lewis Zimmerman","Dr. Soong","Dr. McCoy","Dr. Crusher"],correct:0},
{question:"Which ship first carried a prototype cloaking device for joint testing?",answers:["USS Defiant","USS Enterprise","USS Voyager","USS Horizon"],correct:0},
{question:"Which species’ home network collapsed causing political instability?",answers:["Romulans","Vulcans","Andorians","Bajorans"],correct:0},

// 61–80 Very Hard
{question:"Which Starfleet admiral was leader during the Klingon–Federation peace talks?",answers:["Admiral Leyton","Admiral Nogura","Admiral Quinn","Admiral Cartwright"],correct:0},
{question:"Which Cardassian leader oversaw Bajor occupation most of DS9?",answers:["Gul Dukat","Gul Madred","Gul Evek","Gul Macet"],correct:0},
{question:"Which Starfleet vessel experienced the Nexus phenomenon?",answers:["Enterprise‑B","Enterprise‑D","Voyager","Defiant"],correct:0},
{question:"Which alien telepath taught Wesley Crusher in TNG?",answers:["Calypso","Betazoid","Vulcan","Andorian"],correct:0},
{question:"Which temporal agent organisation pursued Voyager in DS9 crossover?",answers:["Temporal Integrity Commission","Section 31","The Authority","The Enlightened"],correct:0},
{question:"What was the original warp factor achieved by Zefram Cochrane?",answers:["Warp 4","Warp 10","Warp 1","Warp 3"],correct:0},
{question:"Which species communicates in metaphor (e.g., Darmok and Jalad at Tanagra)?",answers:["Tamarians","Vulcans","Andorians","Betazoids"],correct:0},
{question:"Which USS Enterprise model first had a saucer separation capability?",answers:["Refit Constitution","Excelsior","Galaxy","Defiant"],correct:0},
{question:"What is the name of the Klingon homeworld city capital?",answers:["Kronos City","High City","Qo'noS Prime","Capital City"],correct:0},
{question:"Which world was destroyed by the Tholians’ spatial web?",answers:["Defiant’s last patrol location","Risa","Bajor","Qo'noS"],correct:0},
{question:"Who led the Romulan Star Empire during the Dominion War peace treaty?",answers:["Praetor Vreenak","Praetor Shinzon","Praetor Rom","Praetor Sela"],correct:0},
{question:"Which species uses the Rite of Ascension to attain adulthood?",answers:["Klingons","Vulcans","Andorians","Ferengi"],correct:0},
{question:"Which artifact allowed communication with the Q Continuum in Voyager?",answers:["Q’s domain crystal","Temporal beacon","Nexus shard","Continuum key"],correct:0},
{question:"Which class of ship is the USS Titan (Picard’s command)?",answers:["Destiny class","Galaxy class","Sovereign class","Intrepid class"],correct:0},
{question:"Which probe caused life to evolve on many worlds?",answers:["Sehlat array","Genesis device","V’Ger probe","Iconian beacon"],correct:0},
{question:"Which TNG episode introduced the cybernetic collective unit designation?",answers:["The Best of Both Worlds","Q Who","The Neutral Zone","I Borg"],correct:1},

// 81–100 Expert
{question:"Which system houses the Iconian gateway network hub?",answers:["Galaxy 86","Tkon sector","Beta Quadrant","Delta Quadrant"],correct:0},
{question:"Which TOS episode introduced the Gorn species?",answers:["Arena","Balance of Terror","The Corbomite Maneuver","Amok Time"],correct:0},
{question:"What is the official Starfleet term for a warp core breach?",answers:["Red Alert Condition","Warp Core Breach","Critical Containment Failure","Class Omega"],correct:0},
{question:"Which entity exists outside linear time and resides in the Bajoran wormhole?",answers:["The Prophets","The Pah‑wraiths","The Celestial Temple","The Continuum"],correct:0},
{question:"What mysterious organization lurks within Starfleet and engages in covert operations?",answers:["Section 31","The Obsidian Order","Tal Shiar","The Maquis"],correct:0},
{question:"Which legendary figure commanded the original Enterprise in TOS pilot ‘The Cage’?",answers:["Captain Christopher Pike","Captain Kirk","Captain Sulu","Captain Garrovick"],correct:0},
{question:"What entity delivered the Genesis Device blueprint to Starfleet?",answers:["Dr. Julian Bashir","Dr. Carol Marcus","Dr. McCoy","Dr. Soong"],correct:1},
{question:"Which phenomenon created the spatial fold enabling Voyager to cross quadrants quickly?",answers:["Transwarp space","Borg conduit","Wormhole flux","Subspace collapse"],correct:1},
{question:"Which telepathic species attempted to invade the Federation in TNG ‘The Mind’s Eye’?",answers:["Romulans","Cardassians","Borg","Kazon"],correct:0},
{question:"What was the name of the Klingon general who allied with the Federation against the Dominion?",answers:["Martok","Kang","Kor","Koloth"],correct:0},
{question:"What technologically unique Federation facility is found at Utopia Planitia?",answers:["Starfleet Shipyard","Temporal Labs","Omega Particle Research Lab","Adaptive Refitting Facility"],correct:0},
{question:"In Voyager, which weapon did the Krenim Temporal Weapon Ship employ?",answers:["Chroniton torpedo","Disruptor pulse","Photon array","Omega missile"],correct:0},
{question:"Which mineral is essential for warp core regulation?",answers:["Dilithium","Tritanium","Neutronium","Phosphite"],correct:0},
{question:"Which life form served as a sentient holodeck character on Voyager?",answers:["Leonard","Murray","Reginald","Thompson"],correct:1},
{question:"Which Cardassian leader formed a brief alliance with the Federation?",answers:["Gul Madred","Gul Dukat","Gul Evek","Gul Macet"],correct:2},
{question:"Which command philosophy emphasizes infinite diversity in infinite combinations?",answers:["IDIC","Kolinar","The Great Link","Khitomer"],correct:0}
];

// ======= STATE =======
let currentQuestion=0,score=0,playerInitials="",timer,timeLeft=20,streak=0,leaderboard=[];

// ======= UTILITY =======
function shuffleAnswers(q){
    const c=q.correct;
    for(let i=q.answers.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [q.answers[i],q.answers[j]]=[q.answers[j],q.answers[i]];
        if(c===i) q.correct=j;
        else if(c===j) q.correct=i;
    }
}

// ======= QUIZ FUNCTIONS =======
function startQuiz(){
    let input=document.getElementById("initials").value.toUpperCase();
    if(!/^[A-Z]{2,3}$/.test(input)){alert("Enter 2–3 letters."); return;}
    playerInitials=input;
    document.getElementById("intro").style.display="none";
    document.getElementById("quiz").style.display="block";
    currentQuestion=0; score=0; streak=0;
    loadQuestion();
}

function loadQuestion(){
    const q=quizData[currentQuestion];
    shuffleAnswers(q);
    document.getElementById("question-number").textContent=`Question ${currentQuestion+1} of ${quizData.length}`;
    document.getElementById("question-text").textContent=q.question;
    const answersDiv=document.getElementById("answers");
    answersDiv.innerHTML="";
    q.answers.forEach((answer,index)=>{
        const btn=document.createElement("button");
        btn.textContent=answer;
        btn.onclick=()=>checkAnswer(index);
        answersDiv.appendChild(btn);
    });
    timeLeft=20;
    updateTimer();
    clearInterval(timer);
    timer=setInterval(()=>{
        timeLeft--;
        updateTimer();
        if(timeLeft<=0){clearInterval(timer);checkAnswer(-1);}
    },1000);
    document.getElementById("streak").textContent=`Streak: ${streak}`;
}

function updateTimer(){
    const fill=document.getElementById("timer-fill");
    fill.style.width=(timeLeft/20*100)+"%";
    fill.style.background=timeLeft<=10?"#f00":"#ff9900";
}

function checkAnswer(index){
    clearInterval(timer);
    const q=quizData[currentQuestion];
    const buttons=document.querySelectorAll("#answers button");
    buttons.forEach((b,i)=>{
        b.disabled=true;
        if(i===q.correct) b.style.background="#0f0";
        if(index===i && i!==q.correct) b.style.background="#f00";
    });
    if(index===q.correct) {score++; streak++;} else {streak=0;}
    setTimeout(()=>{
        currentQuestion++;
        if(currentQuestion>=quizData.length) endQuiz();
        else loadQuestion();
    },800);
}

// ======= END =======
function endQuiz(){
    document.getElementById("quiz").style.display="none";
    document.getElementById("end").style.display="block";
    document.getElementById("score-display").textContent=`${playerInitials}, your score: ${score}/${quizData.length} (${Math.round(score/quizData.length*100)}%)`;
    if(score/quizData.length>=0.8) document.getElementById("fanfare-msg").style.display="block";
    saveScore();
    renderLeaderboard();
}

function restart(){
    document.getElementById("end").style.display="none";
    document.getElementById("intro").style.display="block";
    document.getElementById("initials").value="";
}

function saveScore(){
    leaderboard.push({initials:playerInitials,score});
    leaderboard.sort((a,b)=>b.score-a.score);
    if(leaderboard.length>10) leaderboard=leaderboard.slice(0,10);
}

function renderLeaderboard(){
    const lb=document.getElementById("leaderboard");
    lb.innerHTML="";
    leaderboard.forEach(item=>{
        const li=document.createElement("li");
        li.textContent=`${item.initials}: ${item.score}`;
        lb.appendChild(li);
    });
}
</script>

</body>
</html>
